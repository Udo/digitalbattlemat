<script type="application/javascript">
	function open_mat_view(id) {
		window.open("/mats/" + id, "battlemat_window", 
		"location=no,menubar=no,resizable=yes,left=0,screenX=0,top=0,screenY=0,status=no,toolbar=no,scrollbars=no,width=100%,height=100%");
	}

	function show_ajax_failure_window(request) {
		var error_window = window.open("");
		error_window.document.write(request.responseText);
	}	
	
	function fill_form_field(id, value) {
		var e = $(id);
		e.value = value;
	}
	
	function ajax_form_submit(form) {
		var action = form.action;
		var method = form.method;
		new Ajax.Request(action, {
			method: method,
			parameters: Form.serialize(form),
			onFailure: function(transport) {
				show_ajax_failure_window(transport);
				document.location.href = "/mats/<%= params[:action] %>";
			}
		});
	}
</script>

<!--
	This is the "enter a name" div. It shall be displayed upon the creation of
	a new map, or whenever the user whishes to change the name.
-->
<div id="mat-name-prompt" class="prompt" style="display: block">
	<h1>Name Battle Mat</h1>
	<p>Please enter a name for the Mat in the field below.</p>
	<% form_for :mat, :url => { :action => "create" } do |f| %>
		<%= f.label :description, 'Description' %>
		<%= f.text_field :description %><br />
		<div class="button-ok" onclick="ajax_form_submit(this.parentNode); hide_prompt('mat-name-prompt');">
		</div>&nbsp;
		<div class="button-cancel" onclick="hide_prompt('mat-name-prompt'); document.location.href = '/mats';">
		</div>
	<% end %>
</div>
<% if params[:action] == 'new' then %>
	<script type="application/javascript">
		display_prompt("mat-name-prompt");
	</script>
<% end %>


<h1>Battle Mat Control</h1>

